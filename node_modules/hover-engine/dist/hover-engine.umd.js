!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n():"function"==typeof define&&define.amd?define(n):n()}(0,function(){"use strict";var t=function(t){return Object.keys(t).map(function(n){return t[n]})},n=function(t,n){return t.concat(n)},e=function(){this.engine={},this.store={},this.actionQueue=[],this.listeners=[],this.actions={}};e.prototype.addActions=function(e){var i=this,r=function(t,n){var e,i=n.name in t?t[n.name].concat(n):[n];return Object.assign({},t,((e={})[n.name]=i,e))};this.engine=Object.keys(e).map(function(n){return function(e){return t(n[e]).map(function(t){return t._storeKey=e,t})}}(e)).reduce(function(n,e){return t(e).reduce(r,n)},this.engine);this.store=Object.keys(e).map(function(t){return{key:t,init:e[t].init}}).reduce(function(t,n){var e;return Object.assign({},t,((e={})[n.key]=n.init(),e))},this.store);return this.actions=t(e).map(function(t){return Object.keys(t)}).reduce(n,[]).reduce(function(t,n){var e;return Object.assign({},t,((e={})[n]=function(t){return function(t,n){var e=function(t){return function(n,e){var r;return Object.assign({},n,((r={})[e._storeKey]=e(n[e._storeKey],t.args,i.actions),r))}},r=0===i.actionQueue.length;for(i.actionQueue.push({actions:i.engine[t],args:n});r&&i.actionQueue.length>0;){var o=i.actionQueue[0],s=e(o);i.store=o.actions.reduce(s,i.store),i.actionQueue.shift(),i.notifyListeners(t,n)}}(n,t)},e))},this.actions),this},e.prototype.addListener=function(t){return this.listeners.push(t),this},e.prototype.notifyListeners=function(t,n){var e=this;return this.listeners.forEach(function(i){return i(e.store,e.actions,t,n)}),this},module.exports=e});
